<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cankarkaoc</title>
    <script src="https://cdn.rawgit.com/sarathsaleem/grained/master/grained.js"></script>
    <link rel="stylesheet" href="styles/navbar.css">
</head>
    
<body>
    <div class="NavBarWrap" id="hero">
        <div class="NavBar stick">
            <div class="hover__div">
                <div class="topLeft"></div>
                <div class="topRight"></div>
                <div class="bottomLeft"></div>
                <div class="bottomRight"></div>
            </div>
            <ul>
                    <li><a href="#"></a>WORK</li>
                    <li><a href="#"></a>ABOUT ME</li>
                    <li class="can-item"><a href="#"></a>CAN</li>
                    <li><a href="#"></a>PLAY</li>
                    <li><a href="#"></a>RESUME</li>
            </ul>
        </div>
    </div>
    </div>
</body>

<script>
    var options = {
      "animate": true,
      "patternWidth": 600,
      "patternHeight": 600,
      "grainOpacity": 1.2,
      "grainDensity": 1.6,
      "grainWidth": 0.2,
      "grainHeight": 0.2,
    }
    
    grained("#hero", options);
    
    const hoverDiv = document.querySelector('.hover__div');
    const navBar = document.querySelector('.NavBar');
    const links = [...navBar.querySelectorAll('li')];
    console.log(links)
    
    const randomLetters = 'QWERTYUIOPASDFGHJKLZXCVBNM'.split('');
    
    navBar.addEventListener('mouseenter', () => {
        hoverDiv.classList.add('active');
    })
    
    navBar.addEventListener('mouseleave', () => {
        hoverDiv.classList.remove('active');
    })
    
    class Link{
        constructor(el, idx){
            this.el = el;
            this.idx = idx;
            this.originalString = el.innerText;
            this.randomString = this.el.innerText.split('');
            console.log(this.randomString)
            this.frame = 0;
            this.addHoverEvent();
        }
    
        addHoverEvent() {
            this.el.addEventListener('mouseenter', () => {
                hoverDiv.style.transform = `translateX(${this.idx * 100}%)`
                this.animate();
            })
    
            this.el.addEventListener('mouseleave', () => {
                this.frame = 0;
                setTimeout(() => {
                    this.frame = 0
                }, 1000)
            })
        }
    
        animate(){
            if(this.frame < 20){
                if(this.frame % 3 == 0){
                    for(let i = 0; i < this.randomString.length; i++){
                        this.randomString[i] = randomLetters[Math.floor(Math.random() * randomLetters.length)];
                    }
                    this.el.innerText = this.randomString.join('');
                }
                this.frame++
                requestAnimationFrame(this.animate.bind(this))
            }else{
                this.el.innerText = this.originalString;
            }
        }
    }
    
    links.forEach((link, idx) => {
        new Link(link, idx)
    })
</script>
</html>